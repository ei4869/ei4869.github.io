<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Blog搭建的一些知识点 | Rei的小站</title><meta name="author" content="Rei"><meta name="copyright" content="Rei"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="记录一下搭建Blog的一些知识点"><meta property="og:type" content="article"><meta property="og:title" content="Blog搭建的一些知识点"><meta property="og:url" content="https://ei4869.github.io/2024/10/22/Blog%E6%90%AD%E5%BB%BA%E7%9A%84%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/index.html"><meta property="og:site_name" content="Rei的小站"><meta property="og:description" content="记录一下搭建Blog的一些知识点"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cloudflare-imgbed-9os.pages.dev/file/1729429010529_kon_30.webp?v=1735920597130"><meta property="article:published_time" content="2024-10-22T02:36:40.000Z"><meta property="article:modified_time" content="2024-11-23T08:52:40.000Z"><meta property="article:author" content="Rei"><meta property="article:tag" content="Blog"><meta property="article:tag" content="Hexo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cloudflare-imgbed-9os.pages.dev/file/1729429010529_kon_30.webp?v=1735920597130"><link rel="shortcut icon" href="/img/1729764735768.webp"><link rel="canonical" href="https://ei4869.github.io/2024/10/22/Blog%E6%90%AD%E5%BB%BA%E7%9A%84%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/index.html"><link rel="preconnect" href="//cdnjs.cloudflare.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/node-snackbar/0.1.16/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.33/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:230},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!0,post:!0},runtime:"",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdnjs.cloudflare.com/ajax/libs/egjs-infinitegrid/4.11.1/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Blog搭建的一些知识点",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-11-23 16:52:40"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="preload" href="https://cloudflare-imgbed-9os.pages.dev/file/1729765205778_1729764735768.webp" as="image"><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/mymusic.css" media="defer" onload='this.media="all"'><svg aria-hidden="true" style="position:absolute;overflow:hidden;width:0;height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248 626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"><style>#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags:before{content:"\A";white-space:pre}#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags>.article-meta__separator{display:none}</style><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><meta name="generator" content="Hexo 6.3.0"><script>window.bgtheme=""</script><script>window.selectedTheme="",console.log("当前mag主题:",window.selectedTheme)</script></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",(()=>{preloader.endLoading()}))</script><script>window.paceOptions={restartOnPushState:!1},document.addEventListener("pjax:send",(()=>{Pace.restart()}))</script><link rel="stylesheet" href="/css/progress_bar.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/iroha.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-home"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-home"></use></svg> <span>首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-guidang"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg> <span>归档</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><i class="fa-fw icon-biaoqian"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-biaoqian"></use></svg> <span>标签</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenleiguanli"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenleiguanli"></use></svg> <span>分类</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-m_whms"></use></svg> <span>仓库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-yinlehe"></use></svg> <span>音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiangce"></use></svg> <span>照片</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/anime/"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg> <span>追番</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-liuyanban"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg> <span>留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon--_guanyu"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon--_guanyu"></use></svg> <span>关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://cloudflare-imgbed-9os.pages.dev/file/1729429010529_kon_30.webp?v=1735920597130')"><nav id="nav"><span id="blog-info"><a href="/" title="Rei的小站"><span class="site-name">Rei的小站</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" aria-label="Search"><svg class="icon-sousuo faa-parent animated-hover" style="height:35px;width:35px;fill:currentColor;position:relative;top:5px"><use xlink:href="#icon-sousuo"></use></svg> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-home"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-home"></use></svg> <span>首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-guidang"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg> <span>归档</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><i class="fa-fw icon-biaoqian"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-biaoqian"></use></svg> <span>标签</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenleiguanli"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenleiguanli"></use></svg> <span>分类</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-m_whms"></use></svg> <span>仓库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-yinlehe"></use></svg> <span>音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiangce"></use></svg> <span>照片</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/anime/"><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg> <span>追番</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-liuyanban"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg> <span>留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon--_guanyu"></i><svg class="menu_icon faa-tada" aria-hidden="true"><use xlink:href="#icon--_guanyu"></use></svg> <span>关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Blog搭建的一些知识点</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-22T02:36:40.000Z" title="发表于 2024-10-22 10:36:40">2024-10-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-11-23T08:52:40.000Z" title="更新于 2024-11-23 16:52:40">2024-11-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B4%E6%B4%BB%E6%8E%A2%E7%B4%A2/">整活探索</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>40分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Blog搭建的一些知识点"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div class="timeline blue"><div class="timeline-item headline"><div class="timeline-item-title"><div class="item-circle"><p>编辑记录</p></div></div></div><div class="timeline-item"><div class="timeline-item-title"><div class="item-circle"><p>2024-10-22 第一次编辑</p></div></div><div class="timeline-item-content"><p>设置随机背景和一些小坑</p></div></div><div class="timeline-item"><div class="timeline-item-title"><div class="item-circle"><p>2024-10-25 第二次编辑</p></div></div><div class="timeline-item-content"><p>其他碎碎念</p></div></div><div class="timeline-item"><div class="timeline-item-title"><div class="item-circle"><p>2024-11-16 第三次编辑</p></div></div><div class="timeline-item-content"><p>完善音乐界面</p></div></div><div class="timeline-item"><div class="timeline-item-title"><div class="item-circle"><p>2024-11-23 第四次编辑</p></div></div><div class="timeline-item-content"><p>解决一些bug</p></div></div><div class="timeline-item"><div class="timeline-item-title"><div class="item-circle"><p>2024-12-09 第五次编辑</p></div></div><div class="timeline-item-content"><p>优化看板娘</p></div></div></div><p>&emsp;&emsp;本文章是作为此次开发个人<strong>Hexo</strong>博客过程遇到的坑及其解决方法的总结。</p><h2 id="怎么设置随机主题背景"><a href="#怎么设置随机主题背景" class="headerlink" title="怎么设置随机主题背景"></a>怎么设置随机主题背景</h2><h3 id="随机文章封面背景"><a href="#随机文章封面背景" class="headerlink" title="随机文章封面背景"></a>随机文章封面背景</h3><p>&emsp;&emsp;随机文章封面的实现使用的是hexo后端静态的js脚本实现，在<code>\themes\butterfly\scripts</code>中新建<code>random_img.js</code>，每当重新hexo三连时，都会执行这里的js，不过是静态的，不能动态变化，即不能刷新网页执行。<br>&emsp;&emsp;该脚本的思路是：通过<code>hexo.theme.config.xxx</code>来读取主题配置文件(<code>_config.butterfly.yml</code>)的对应参数，这里是<code>mytheme</code>，读取之后根据是否有值来决定根据日期随机还是选择某个确定主题。<br>&emsp;&emsp;该脚本不需要<em>inject</em>注入，这里设置文章封面本质还是获取了主题配置文件的<code>cover</code>参数进行封面设置。</p><h3 id="随机小站背景"><a href="#随机小站背景" class="headerlink" title="随机小站背景"></a>随机小站背景</h3><p>&emsp;&emsp;设置随机背景，使用的是前端能动态刷新的js脚本实现，并与后端js进行通信传递参数，在<code>\themes\butterfly\source\js</code>中新建<code>randombg.js</code>，此为前端脚本，负责刷新封面；在<code>\themes\butterfly\scripts</code>中新建<code>setbgtheme.js</code>，此为后端脚本，负责获取主题配置文件参数，并传递到前端js。<br>&emsp;&emsp;<code>setbgtheme.js</code>的代码如下：<br></p><div class="tabs" id="setbgtheme"><ul class="nav-tabs"><button type="button" class="tab" data-href="setbgtheme-1">setbgtheme 1</button><button type="button" class="tab active" data-href="setbgtheme-2">setbgtheme 2</button></ul><div class="tab-contents"><div class="tab-item-content" id="setbgtheme-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;after_render:html&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> bgtheme = hexo.<span class="property">theme</span>.<span class="property">config</span>.<span class="property">bgtheme</span>;</span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;/head&gt;&#x27;</span>, <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">            window.bgtheme = &quot;<span class="subst">$&#123;bgtheme&#125;</span>&quot;;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><div class="tab-item-content active" id="setbgtheme-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;after_render:html&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> bgtheme = hexo.<span class="property">theme</span>.<span class="property">config</span>.<span class="property">Mytheme</span>;</span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;/head&gt;&#x27;</span>, <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">            window.bgtheme = &quot;<span class="subst">$&#123;bgtheme&#125;</span>&quot;;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><br>作用是在渲染html后，获取主题配置文件的参数<code>bgtheme</code>，并通过<code>window.bgtheme</code>传递到前端脚本。<br>&emsp;&emsp;<code>randombg.js</code>的类似前面随机文章封面，但设置封面是通过<code>F12</code>获取网站对应封面元素，再进行设置，但注意，由于设置封面是使用了<code>url()</code>的形式，其中的图片链接参数的空格会被忽略，因此要加上空格转换为<code>%20</code>的代码<code>const backgroundUrl = backimg.replace(/ /g, &quot;%20&quot;)</code>，此外，要想获取到封面元素，主题配置文件中的参数<code>background</code>必须要设置一个默认封面，网页才能渲染出元素用于脚本获取。（该脚本需要在主题配置文件进行<em>inject</em>注入，每次刷新网页都会进行更新）<p></p><h3 id="随机磁贴封面背景"><a href="#随机磁贴封面背景" class="headerlink" title="随机磁贴封面背景"></a>随机磁贴封面背景</h3><p>&emsp;&emsp;设置随机背景，使用的是前端能动态刷新的js脚本实现，并与后端js进行通信传递参数，在<code>\themes\butterfly\source\js</code>中新建<code>random_mag_bg.js</code>，此为前端脚本，负责刷新封面；在<code>\themes\butterfly\scripts</code>中新建<code>setmagtheme.js</code>，此为后端脚本，负责获取配置文件(<code>_config.yml</code>)参数，并传递到前端js。<br>&emsp;&emsp;<code>setmagtheme.js</code>的代码如下：<br></p><div class="tabs" id="setmagtheme"><ul class="nav-tabs"><button type="button" class="tab" data-href="setmagtheme-1">setmagtheme 1</button><button type="button" class="tab active" data-href="setmagtheme-2">setmagtheme 2</button></ul><div class="tab-contents"><div class="tab-item-content" id="setmagtheme-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;after_render:html&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; config &#125; = hexo;</span><br><span class="line">    <span class="comment">// 读取选定主题</span></span><br><span class="line">    <span class="keyword">const</span> selectedTheme = config.<span class="property">selected_theme</span>; </span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;/head&gt;&#x27;</span>, <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">            window.selectedTheme = &quot;<span class="subst">$&#123;selectedTheme&#125;</span>&quot;;</span></span><br><span class="line"><span class="string">            console.log(&quot;当前mag主题:&quot;, window.selectedTheme);</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><div class="tab-item-content active" id="setmagtheme-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;after_render:html&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> selectedTheme = hexo.<span class="property">theme</span>.<span class="property">config</span>.<span class="property">Mytheme</span></span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;/head&gt;&#x27;</span>, <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">            window.selectedTheme = &quot;<span class="subst">$&#123;selectedTheme&#125;</span>&quot;;</span></span><br><span class="line"><span class="string">            console.log(&quot;当前mag主题:&quot;, window.selectedTheme);</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p></p><p>由此将配置文件的参数<code>config.selected_theme</code>通过<code>window.selectedTheme</code>传递到前端js。<br>&emsp;&emsp;<code>random_mag_bg.js</code>与<code>randobg.js</code>类似，也是获取网页对应部分元素设置背景图片，不过不需要在配置文件先配置<code>message.cover</code>，但同样需要在主题配置文件注入。</p><div class="tip warning faa-horizontal animated-hover"><p>有空时可以将配置文件的三个theme合为一个</p></div><div class="note success simple"><p>已成功统一参数为Mytheme 2024.10.25</p></div><h2 id="一些小坑"><a href="#一些小坑" class="headerlink" title="一些小坑"></a>一些小坑</h2><h3 id="自动部署遇到问题"><a href="#自动部署遇到问题" class="headerlink" title="自动部署遇到问题"></a>自动部署遇到问题</h3><ul><li>在<code>Github Actions</code>启动自动部署时，发现当按时间触发时，<code>random_img.js</code>并没有按日期更换主题，而当<code>push</code>触发时，却能切换，查找资料，<del>发现原来是因为时间触发时没有清理图片缓存导致没法更新 ，解决方法就是在图片链接后加<code>&#39;?v=&#39; + new Date().getTime()</code>，例如<code>https://cloudflare-imgbed-9os.pages.dev/file/1729429003335_kon_24.webp?v=1729578064697</code>。</del> 这样每次加载图片都会变化，但加上这个字符串并不会影响原来图片的有效性。</li><li>在首次进行自动部署时，需要获取追番信息的话，需要在<code>autodeploy.yml</code>中加入相应代码：<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生成静态文件</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    hexo bangumi -u #或者hexo bangumi -u &#x27;SESSDATA&#x27;</span></span><br><span class="line"><span class="string">    hexo clean</span></span><br><span class="line"><span class="string">    hexo generate</span></span><br></pre></td></tr></table></figure></li><li><p><a target="_blank" rel="noopener" href="https://akilar.top/posts/f752c86d/"><code>Github Pages</code>全自动部署教程</a></p></li><li><p>10.25更新：重新写一个自动部署程序，前面通过在图片后加日期字符串并不起作用，于是采用<code>hexo deploy</code>的方式进行部署。步骤如下：</p><ul><li><strong>在生成</strong>SSH<strong>密钥时，确保生成 PEM 格式的密钥</strong>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -m PEM -C <span class="string">&quot;your_email@example.com&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>将 SSH 公钥添加到 GitHub</strong>：<ul><li>打开 GitHub 网站，在你的用户设置中找到 <code>Settings &gt; SSH and GPG keys</code></li><li>点击 <code>New SSH key</code>，将生成的 <code>id_ed25519.pub(假如是id_ed25519)</code> 文件中的内容复制并粘贴到 GitHub 的 SSH 公钥输入框中。</li></ul></li><li><strong>在 GitHub Actions 中添加 SSH 私钥</strong>：<ul><li>进入你的 GitHub 项目页面，点击 <code>Settings &gt; Secrets and variables &gt; Actions</code>。</li><li>添加一个新的 <code>Secret</code>，命名为 <code>ACTIONS_DEPLOY_KEY</code>，并将 <code>id_ed25519</code> 文件的内容复制进去。注意，这里是 SSH 的私钥。</li></ul></li><li><strong>修改 _config.yml 使用 SSH URL</strong>：<ul><li>使用 SSH URL 代替 HTTPS，修改 _config.yml 文件的 deploy 配置，如下所示：<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:ei4869/ei4869.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure></li></ul></li><li><strong>更新 GitHub Actions 工作流以支持 SSH</strong>：<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">自动部署</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">release:</span></span><br><span class="line">    <span class="attr">types:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">published</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">schedule:</span></span><br><span class="line">    <span class="comment"># 每天的0点和3点（北京时间）自动部署</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">cron:</span> <span class="string">&#x27;0 16 * * *&#x27;</span>  <span class="comment"># UTC时间16点对应北京时间0点.</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">cron:</span> <span class="string">&#x27;0 19 * * *&#x27;</span>  <span class="comment"># UTC时间19点对应北京时间3点.</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">检查分支</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">ref:</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Node</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">node-version:</span> <span class="string">&quot;20.x&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">设置时区</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;TZ=&#x27;Asia/Shanghai&#x27;&quot;</span> <span class="string">&gt;&gt;</span> <span class="string">$GITHUB_ENV.</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Hexo</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">        npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">缓存</span> <span class="string">Hexo</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/cache@v1</span></span><br><span class="line">      <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">        <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.OS</span> <span class="string">&#125;&#125;-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装依赖</span></span><br><span class="line">      <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生成静态文件</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        export TZ=&#x27;Asia/Shanghai&#x27;  # 设置时区</span></span><br><span class="line"><span class="string">        hexo clean</span></span><br><span class="line"><span class="string">        hexo generate</span></span><br><span class="line"><span class="string">        gulp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">配置</span> <span class="string">Git</span> <span class="string">用户信息和分支</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        git config --global user.name &quot;$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;&quot;</span></span><br><span class="line"><span class="string">        git config --global user.email &quot;$&#123;&#123; secrets.GITHUBEMAIL &#125;&#125;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">设置</span> <span class="string">SSH</span> <span class="string">密钥</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">webfactory/ssh-agent@v0.5.3</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">ssh-private-key:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACTIONS_DEPLOY_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">部署</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">        <span class="string">hexo</span> <span class="string">deploy</span></span><br></pre></td></tr></table></figure>通过以上，能实现定时自动重启项目，并且随机文章封面能定时更新。<h3 id="hexo-butterfly-categories-card插件bug"><a href="#hexo-butterfly-categories-card插件bug" class="headerlink" title="hexo-butterfly-categories-card插件bug"></a>hexo-butterfly-categories-card插件bug</h3>&emsp;&emsp;该插件bug显示的分类的名字和描述对应不上，于是暂时没有其他方法，只能不设置<code>message.descr</code>参数，即不显示描述。</li></ul></li></ul><h3 id="自定义一个樱花飘落脚本"><a href="#自定义一个樱花飘落脚本" class="headerlink" title="自定义一个樱花飘落脚本"></a>自定义一个樱花飘落脚本</h3><p>&emsp;&emsp;原脚本樱花是全屏飘落，我在<code>gallery\index.md</code>中通过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>进行注入，但要想部分区域注入樱花特效的话，我新建了<code>js\sakuraa.js</code>，通过修改获取的网页的元素可进行指定区域内飘落。</p><h3 id="相册界面魔改"><a href="#相册界面魔改" class="headerlink" title="相册界面魔改"></a>相册界面魔改</h3><p>&emsp;&emsp;本质通过外挂标签设置图库集合，在其<code>index.md</code>中添加：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>但我为了指定单独修改<code>gallery</code>的界面，为其添加了指定的类<code>gallery-page</code>，如下：(10.25，更好的指定class的方法)<br><div class="tabs" id="gallery-page"><ul class="nav-tabs"><button type="button" class="tab" data-href="gallery-page-1">gallery-page 1</button><button type="button" class="tab active" data-href="gallery-page-2">gallery-page 2</button></ul><div class="tab-contents"><div class="tab-item-content" id="gallery-page-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;gallery-page&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content active" id="gallery-page-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="code">    &lt;div class=&quot;gallery-group-main&quot;&gt;</span></span><br><span class="line"><span class="code">    &#123;% galleryGroup name description link img-url %&#125;</span></span><br><span class="line"><span class="code">    &#123;% galleryGroup name description link img-url %&#125;</span></span><br><span class="line"><span class="code">    &#123;% galleryGroup name description link img-url %&#125;</span></span><br><span class="line"><span class="code">    &lt;/div&gt;</span></span><br><span class="line"><span class="code">    &lt;script&gt;</span></span><br><span class="line"><span class="code">    document.addEventListener(&quot;DOMContentLoaded&quot;, function() &#123;</span></span><br><span class="line"><span class="code">        document.body.classList.add(&#x27;gallery-page&#x27;); </span></span><br><span class="line"><span class="code">    &#125;);</span></span><br><span class="line"><span class="code">    &lt;/script&gt;</span></span><br><span class="line"><span class="code">&lt;/body&gt;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><br>这样该页面就有了一个独立的指明身份的class。<span class="p red">(使用script脚本注入，动态更改body的class为指定class，不会被其他样式改变，保证class为想要的class)</span>而后续要改动该页面样式，比如去除页面里的文本白框，让放置的图片融于背景，只需调节css样式：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 特定页面（如gallery页面）样式设置 */</span></span><br><span class="line"><span class="selector-class">.gallery-page</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*设置单独相册背景*/</span></span><br><span class="line"><span class="selector-class">.gallery-page</span> <span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">https://cloudflare-imgbed-9os.pages.dev/file/1729429000558_kon_23.webp</span>) <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">background-size</span>: cover <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">background-position</span>: center center <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat <span class="meta">!important</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.gallery-page</span> <span class="selector-class">.page</span> <span class="selector-id">#page-header</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.gallery-page</span> <span class="selector-class">.page</span> <span class="selector-id">#content-inner</span> <span class="selector-id">#page</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">border</span>: none <span class="meta">!important</span>;      <span class="comment">/*去除边框*/</span></span><br><span class="line">  backdrop-<span class="attribute">filter</span>: none <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;   <span class="comment">/*去除阴影*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.gallery-page</span> <span class="selector-class">.page</span> <span class="selector-id">#footer</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.gallery-page</span> <span class="selector-class">.page</span> <span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: initial <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>之后，要去除子图库的背景白框时，只需要在其md文件中，指定class为<code>gallery-page</code>即可，例如：<br><div class="tabs" id="gallery-page"><ul class="nav-tabs"><button type="button" class="tab" data-href="gallery-page-1">gallery-page 1</button><button type="button" class="tab active" data-href="gallery-page-2">gallery-page 2</button></ul><div class="tab-contents"><div class="tab-item-content" id="gallery-page-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;gallery-page&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://cloudflare-imgbed-9os.pages.dev/file/1729306187581_kon_12.webp</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content active" id="gallery-page-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://cloudflare-imgbed-9os.pages.dev/file/1729306187581_kon_12.webp</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="code">    document.addEventListener(&quot;DOMContentLoaded&quot;, function() &#123;</span></span><br><span class="line"><span class="code">        document.body.classList.add(&#x27;gallery-page&#x27;); // 将类名添加为 music-page</span></span><br><span class="line"><span class="code">    &#125;);</span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br><span class="line"><span class="code">&lt;/body&gt;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p></p><p>&emsp;&emsp;还有个小坑，子图库界面一开始加载时，里面的图片会一直抖动，也就是高一直在微微变化，查找资料发现是因为图片样式没有固定，导致为了适应布局图片会自己一直在变，解决方法是在css中加入固定样式的代码：<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 调节相册样式，防止抖动 */</span></span><br><span class="line"><span class="selector-class">.gallery-items</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden; <span class="comment">/* 防止内容溢出 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">348px</span>; <span class="comment">/* 你可以根据需要调整 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">205px</span>; <span class="comment">/* 确保所有图片区域的大小一致 */</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/* 去掉默认外边距 */</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>; <span class="comment">/* 去掉默认内边距 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">object-fit</span>: cover; <span class="comment">/* 确保图片保持比例并覆盖整个容器 */</span></span><br><span class="line">  <span class="attribute">display</span>: block; <span class="comment">/* 去除图片底部的空白空间 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-class">.gallery-page</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden; <span class="comment">/* 避免水平滚动 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="移动端背景图片样式改进"><a href="#移动端背景图片样式改进" class="headerlink" title="移动端背景图片样式改进"></a>移动端背景图片样式改进</h3><p>&emsp;&emsp;在手机端背景图片会只显示一部分，为了解决这个问题，在css中加入代码，使能容纳完整图片，虽然图片不会充满区域，但观感更好吧(额额，其实cover的话也还行吧)。<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 调节背景图片 */</span></span><br><span class="line"><span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">  <span class="attribute">background-size</span>: cover; <span class="comment">/* 确保背景图片覆盖整个容器 */</span></span><br><span class="line">  <span class="attribute">background-position</span>: center center; <span class="comment">/* 将背景图片居中显示 */</span></span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat; <span class="comment">/* 防止背景图片重复 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>; <span class="comment">/* 将背景高度设置为视口高度 */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>; <span class="comment">/* 将背景宽度设置为视口宽度 */</span></span><br><span class="line">  <span class="attribute">overflow</span>: hidden; <span class="comment">/* 确保背景图片不会超出边界 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 针对移动端调整 */</span></span><br><span class="line"><span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">      <span class="attribute">background-size</span>: contain; <span class="comment">/* 确保移动端背景图片按比例缩放 */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="Aplayer播放器"><a href="#Aplayer播放器" class="headerlink" title="Aplayer播放器"></a>Aplayer播放器</h3><p>&emsp;&emsp;音乐播放器魔改参考链接：<a target="_blank" rel="noopener" href="https://blog.anheyu.com/posts/c3d3.html#%E9%AD%94%E6%94%B9%E6%AD%A5%E9%AA%A4">魔改音乐播放器</a></p><h3 id="Aplayer播放器魔改-自改版本"><a href="#Aplayer播放器魔改-自改版本" class="headerlink" title="Aplayer播放器魔改(自改版本)"></a>Aplayer播放器魔改(自改版本)</h3><p>&emsp;&emsp;为了解决anzhiyu版本的bug，只能自己重写一个界面，不过更简单，但解决了bug。我的播放器用了官方的播放器样式。</p><ul><li><strong>主题配置文件引入js:</strong><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></li><li><strong>配置music的md文件</strong><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 音乐馆</span><br><span class="line">date: 2021-04-24 21:41:30</span><br><span class="line"><span class="section"># type: music</span></span><br><span class="line">aplayer: true</span><br><span class="line">top<span class="emphasis">_img: false</span></span><br><span class="line"><span class="emphasis">comments: false</span></span><br><span class="line"><span class="emphasis">aside: false</span></span><br><span class="line"><span class="emphasis">---</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;music-page&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">&#123;% meting &quot;9224307215&quot; &quot;tencent&quot; &quot;playlist&quot; &quot;autoplay&quot; &quot;mutex:false&quot; &quot;listmaxheight:440px&quot; &quot;preload:none&quot; &quot;theme:#ad7a86&quot;%&#125;</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">    document.addEventListener(&quot;DOMContentLoaded&quot;, function() &#123;</span></span><br><span class="line"><span class="emphasis">        document.body.classList.add(&#x27;music-page&#x27;); // 将类名添加为 music-page</span></span><br><span class="line"><span class="emphasis">    &#125;);</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"> <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">    // 获取 class 为 page 的第一个元素</span></span><br><span class="line"><span class="emphasis">    const pageElement = document.querySelector(&#x27;.page&#x27;);</span></span><br><span class="line"><span class="emphasis">    if (pageElement) &#123;</span></span><br><span class="line"><span class="emphasis">        // 查找其子元素中是否有 ID 为 page 的元素</span></span><br><span class="line"><span class="emphasis">        const childElement = pageElement.querySelector(&#x27;#page&#x27;);</span></span><br><span class="line"><span class="emphasis">        if (childElement) &#123;</span></span><br><span class="line"><span class="emphasis">                // 修改元素的 ID</span></span><br><span class="line"><span class="emphasis">            childElement.id = &#x27;music-page&#x27;;</span></span><br><span class="line"><span class="emphasis">        &#125;</span></span><br><span class="line"><span class="emphasis">    &#125;</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">  document.addEventListener(&quot;DOMContentLoaded&quot;, function() &#123;</span></span><br><span class="line"><span class="emphasis">    // 获取需要调整的元素</span></span><br><span class="line"><span class="emphasis">    const contentInner = document.getElementById(&quot;content-inner&quot;);</span></span><br><span class="line"><span class="emphasis">    const musicPage = document.getElementById(&quot;music-page&quot;);</span></span><br><span class="line"><span class="emphasis">    const pageTitle = musicPage.querySelector(&quot;.page-title&quot;);</span></span><br><span class="line"><span class="emphasis">    if (pageTitle) &#123;</span></span><br><span class="line"><span class="emphasis">      // 在 content-inner 之后插入标题</span></span><br><span class="line"><span class="emphasis">      contentInner.insertAdjacentElement(&#x27;beforebegin&#x27;, pageTitle);</span></span><br><span class="line"><span class="emphasis">      pageTitle.style.textAlign = &#x27;center&#x27;;</span></span><br><span class="line"><span class="emphasis">      pageTitle.style.marginTop = &#x27;0px&#x27;; // 可以根据需要调整</span></span><br><span class="line"><span class="emphasis">        &#125;</span></span><br><span class="line"><span class="emphasis">    &#125;);</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;universe&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">&quot;/js/universe.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure>先不管后面的脚本注入，主要是<code>&#123;% meting "9224307215" "tencent" "playlist" "autoplay" "mutex:false" "listmaxheight:440px" "preload:none" "theme:#ad7a86"%&#125;</code>这里使用<code>meting</code>引入播放器，<code>listmaxheight</code>是歌单列表长度，<code>theme</code>是歌曲封面背景色(不是歌单页面背景色)。</li><li><strong>配置music页面特征ID：</strong><br>首先为了和其他页面区分开来，给界面一个独立的<code>class</code>也就是<code>music-page</code>，通过脚本注入:<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;music-page&#x27;</span>); <span class="comment">// 将类名添加为 music-page</span></span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>再给后面的<code>class:page</code>的<code>id:page</code>的子元素重命名为<code>id:music-page</code>：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;script&gt;</span><br><span class="line">    <span class="comment">// 获取 class 为 page 的第一个元素</span></span><br><span class="line">    <span class="keyword">const</span> pageElement = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.page&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (pageElement) &#123;</span><br><span class="line">        <span class="comment">// 查找其子元素中是否有 ID 为 page 的元素</span></span><br><span class="line">        <span class="keyword">const</span> childElement = pageElement.<span class="title function_">querySelector</span>(<span class="string">&#x27;#page&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (childElement) &#123;</span><br><span class="line">                <span class="comment">// 修改元素的 ID</span></span><br><span class="line">            childElement.<span class="property">id</span> = <span class="string">&#x27;music-page&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>这样能方便指定<code>id</code>调整css样式。</li><li><strong>调整css</strong><br>由于css代码比较多，所以直接新建一个<code>mymusic.css</code>，后续再在主题配置文件注入即可。配置内容为：<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*消除文本框，使用透明背景*/</span></span><br><span class="line"><span class="selector-class">.page</span> <span class="selector-id">#music-page</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>; <span class="comment">/* 设置背景透明 */</span></span><br><span class="line">    <span class="attribute">border</span>: none <span class="meta">!important</span>;            <span class="comment">/* 去除边框 */</span></span><br><span class="line">    <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;       <span class="comment">/* 去除阴影 */</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#article-container</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>) <span class="meta">!important</span>; <span class="comment">/* 透明背景 */</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>) <span class="meta">!important</span>; <span class="comment">/* 可选：半透明边框 */</span></span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">80px</span>;   <span class="comment">/*调节整个歌单和顶部的距离*/</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*调节整个歌单的背景色，这里是淡灰色*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> &#123;</span><br><span class="line">    <span class="comment">/* opacity: 0.6; */</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">235</span>, <span class="number">224</span>, <span class="number">224</span>, <span class="number">0.395</span>) <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*固定整个页面，禁止垂直滚动，这里z-index设为auto，防止因为z-index设置不合适导致进度条和音量按钮bug*/</span></span><br><span class="line">  <span class="selector-id">#music-page</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;   <span class="comment">/* 使其固定在屏幕上 */</span></span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;            <span class="comment">/* 距离顶部 0 */</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;           <span class="comment">/* 距离左侧 0 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100vw</span>;      <span class="comment">/* 占满视口的宽度 */</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vh</span>;     <span class="comment">/* 占满视口的高度 */</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden;  <span class="comment">/* 禁用内部滚动条 */</span></span><br><span class="line">    <span class="attribute">z-index</span>: auto;     <span class="comment">/* 确保在其他内容之上 */</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#ffffff</span>; <span class="comment">/* 可选：设置背景颜色 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 隐藏整个页面的水平滚动条 */</span></span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*自设music页面单独背景，指定为music-page里的web_bg*/</span></span><br><span class="line">  <span class="selector-class">.music-page</span> <span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">https://cloudflare-imgbed-9os.pages.dev/file/1729677618289_8b35b49fcc4e3a1c37c128f8c1eff16b558fb1bb.jpg@1256w_708h_!web-article-pic.webp</span>) <span class="meta">!important</span>; </span><br><span class="line">    <span class="attribute">background-size</span>: cover <span class="meta">!important</span>; </span><br><span class="line">    <span class="attribute">background-position</span>: center center <span class="meta">!important</span>; </span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat <span class="meta">!important</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*调整歌曲列表，每行的高度和字体大小，行变宽字体变大*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span>&#123;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">45px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">15px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-withlrc</span> <span class="selector-class">.aplayer-info</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">7px</span> <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.page</span> <span class="selector-id">#music-page</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*加粗歌曲标题作者歌词的文字*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-music</span> <span class="selector-class">.aplayer-title</span>,</span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-music</span> <span class="selector-class">.aplayer-author</span>,</span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-lrc</span> <span class="selector-tag">p</span><span class="selector-class">.aplayer-lrc-current</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold <span class="meta">!important</span>; <span class="comment">/* 加粗文字 */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span> <span class="meta">!important</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*加粗歌曲列表的标题作者索引的文字*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span> <span class="selector-class">.aplayer-list-title</span>,</span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span> <span class="selector-class">.aplayer-list-author</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold <span class="meta">!important</span>; <span class="comment">/* 加粗文字 */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span> <span class="meta">!important</span>; </span><br><span class="line">  &#125; </span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span> <span class="selector-class">.aplayer-list-index</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold <span class="meta">!important</span>; <span class="comment">/* 加粗索引 */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span> <span class="meta">!important</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*加深显示播放时间颜色*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> <span class="selector-class">.aplayer-time-inner</span>&#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold <span class="meta">!important</span>; </span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span> <span class="meta">!important</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*加深显示图标颜色*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> <span class="selector-class">.aplayer-icon</span> <span class="selector-tag">svg</span>&#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">brightness</span>(<span class="number">0.2</span>) <span class="meta">!important</span>; <span class="comment">/*降低填充亮度*/</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> <span class="selector-class">.aplayer-icon</span> <span class="selector-tag">svg</span> <span class="selector-tag">path</span>&#123;</span><br><span class="line">    <span class="attribute">stroke</span>: <span class="number">#333</span> <span class="meta">!important</span>;  <span class="comment">/*加深轮廓线条颜色*/</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*调整歌单列表，每一行的上下边框颜色使其变浅*/</span></span><br><span class="line">  <span class="selector-id">#article-container</span> <span class="selector-class">.aplayer</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">232</span>, <span class="number">208</span>, <span class="number">208</span>, <span class="number">0.5</span>) <span class="meta">!important</span>; <span class="comment">/* 使用RGBA来设置边框颜色，使其变浅 */</span></span><br><span class="line">    <span class="comment">/* 你可以根据需要调整边框宽度和样式 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*调整歌单最左侧指示条的颜色*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span><span class="selector-class">.aplayer-list-light</span> <span class="selector-class">.aplayer-list-cur</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#0a1de9</span> <span class="meta">!important</span>; <span class="comment">/* 设置新的背景颜色 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">   <span class="comment">/*调整歌单列表当前播放曲目的背景高亮颜色*/</span></span><br><span class="line">  <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span><span class="selector-class">.aplayer-list-light</span>  &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f2f5ea</span> <span class="meta">!important</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*隐藏版权说明*/</span></span><br><span class="line">  <span class="selector-id">#footer-wrap</span> <span class="selector-class">.copyright</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*隐藏模型*/</span></span><br><span class="line">  <span class="selector-class">.music-page</span> <span class="selector-id">#live2d-widget</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 适用于移动端的媒体查询 */</span></span><br><span class="line">  <span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="comment">/* 适配 #music-page */</span></span><br><span class="line">    <span class="selector-id">#music-page</span> &#123;</span><br><span class="line">      <span class="attribute">position</span>: fixed;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100vw</span>;      <span class="comment">/* 占满视口宽度 */</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100vh</span>;     <span class="comment">/* 占满视口高度 */</span></span><br><span class="line">      <span class="attribute">overflow-y</span>: auto;  <span class="comment">/* 启用垂直滚动 */</span></span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#ffffff</span>; <span class="comment">/* 可选：背景颜色 */</span></span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">10px</span>;     <span class="comment">/* 为移动端增加内边距 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 适配标题，直接隐藏 */</span></span><br><span class="line">    <span class="selector-class">.music-page</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 适配 #article-container */</span></span><br><span class="line">    <span class="selector-id">#article-container</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>) <span class="meta">!important</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>) <span class="meta">!important</span>;</span><br><span class="line">      <span class="attribute">margin-top</span>: <span class="number">60px</span>;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">10px</span>;         <span class="comment">/* 增加内边距，使内容更贴合移动端 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 适配 APlayer 音乐播放器 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">235</span>, <span class="number">224</span>, <span class="number">224</span>, <span class="number">0.5</span>) <span class="meta">!important</span>; <span class="comment">/* 半透明背景 */</span></span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 调整播放列表的字体和间距 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">40px</span> <span class="meta">!important</span>;  <span class="comment">/* 调整行高 */</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">14px</span> <span class="meta">!important</span>;     <span class="comment">/* 调整字体大小 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 调整歌词部分 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-music</span> <span class="selector-class">.aplayer-title</span>,</span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-music</span> <span class="selector-class">.aplayer-author</span>,</span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-lrc</span> <span class="selector-tag">p</span><span class="selector-class">.aplayer-lrc-current</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">14px</span> <span class="meta">!important</span>;    <span class="comment">/* 调整歌词字体大小 */</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#333</span> <span class="meta">!important</span>;        <span class="comment">/* 设置字体颜色 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 调整播放时间的显示，更易读 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> <span class="selector-class">.aplayer-time-inner</span> &#123;</span><br><span class="line">      <span class="attribute">font-weight</span>: bold <span class="meta">!important</span>; </span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#333</span> <span class="meta">!important</span>; </span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">14px</span> <span class="meta">!important</span>;  <span class="comment">/* 调整字体大小，适合移动设备 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 针对移动端：调节图标填充亮度 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> <span class="selector-class">.aplayer-icon</span> <span class="selector-tag">svg</span> &#123;</span><br><span class="line">      <span class="attribute">filter</span>: <span class="built_in">brightness</span>(<span class="number">0.3</span>) <span class="meta">!important</span>; <span class="comment">/* 略微减小亮度调节 */</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">18px</span> <span class="meta">!important</span>;  <span class="comment">/* 调整图标大小，适合移动端 */</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">18px</span> <span class="meta">!important</span>; <span class="comment">/* 确保图标在移动端的可点击性 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/* 针对移动端：加深图标线条颜色 */</span></span><br><span class="line">      <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> <span class="selector-class">.aplayer-icon</span> <span class="selector-tag">svg</span> <span class="selector-tag">path</span> &#123;</span><br><span class="line">        <span class="attribute">stroke</span>: <span class="number">#333</span> <span class="meta">!important</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 播放器控制按钮适配 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> &#123;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span> <span class="meta">!important</span>;     <span class="comment">/* 调整内边距 */</span></span><br><span class="line">      <span class="attribute">margin-top</span>: <span class="number">0px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 播放列表项目的边框 */</span></span><br><span class="line">    <span class="selector-id">#article-container</span> <span class="selector-class">.aplayer</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">232</span>, <span class="number">208</span>, <span class="number">208</span>, <span class="number">0.5</span>) <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 设置播放列表项目的背景颜色 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span><span class="selector-class">.aplayer-list-light</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#f2f5ea</span> <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 隐藏版权信息 */</span></span><br><span class="line">    <span class="selector-id">#footer-wrap</span> <span class="selector-class">.copyright</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 设置控制栏和播放列表之间的空隙 */</span></span><br><span class="line">    <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> &#123;</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>对于音乐界面标题的处理，直接在md文件注入js，动态调整其位置，使其上升到<code>content-inner</code>级，居中加粗显示:<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 获取需要调整的元素</span></span><br><span class="line">    <span class="keyword">const</span> contentInner = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;content-inner&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> musicPage = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;music-page&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> pageTitle = musicPage.<span class="title function_">querySelector</span>(<span class="string">&quot;.page-title&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (pageTitle) &#123;</span><br><span class="line">      <span class="comment">// 在 content-inner 之后插入标题</span></span><br><span class="line">      contentInner.<span class="title function_">insertAdjacentElement</span>(<span class="string">&#x27;beforebegin&#x27;</span>, pageTitle);</span><br><span class="line">      pageTitle.<span class="property">style</span>.<span class="property">textAlign</span> = <span class="string">&#x27;center&#x27;</span>;</span><br><span class="line">      pageTitle.<span class="property">style</span>.<span class="property">marginTop</span> = <span class="string">&#x27;0px&#x27;</span>; <span class="comment">// 可以根据需要调整</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>通过以上，PC端和移动端的音乐界面都能正常显示，没有bug啦!你的名字夜晚飞星的蓝黑天空加上几乎透明浅灰的歌单列表，还是挺适配的。至此，自改的Aplayer播放器还算可以。</li></ul><h3 id="其它碎碎念-10-25"><a href="#其它碎碎念-10-25" class="headerlink" title="其它碎碎念(10.25)"></a>其它碎碎念(10.25)</h3><h4 id="随机磁贴封面的bug"><a href="#随机磁贴封面的bug" class="headerlink" title="随机磁贴封面的bug"></a>随机磁贴封面的bug</h4><p>&emsp;&emsp;昨天还是会出现偶尔磁贴封面图片为null的情况，明明图片链接都有效，明明使用了<code>IntersectionObserver</code>懒加载，而且再次刷新页面大概率就又正常了，今天重新改下代码，<del>加入了获取随机图片时如果获取为null再次获取的代码，看起来稳定了很多，刷了n遍界面都没问题，但不知道还会不会出现，看后续表现吧，贴上改后代码:</del> <span class="p red">10.25 16:34:</span>呜呜，好像彻底解决了啊，原来是<code>addEventListener(&#39;DOMContentLoaded&#39;,);</code>的问题啊，改用 <code>window.onload</code> 而不是 <code>DOMContentLoaded</code>，能确保所有资源和元素都已加载。贴上再次改进后的完整代码：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>; </span><br><span class="line"><span class="comment">// 在所有资源加载完成后执行脚本</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 定义主题图片对象</span></span><br><span class="line">    <span class="keyword">const</span> themes = &#123;</span><br><span class="line">        <span class="attr">kon</span>: [</span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729306198549_kon_5.webp&quot;</span>,</span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729306191301_kon_7.webp&quot;</span>,</span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729306191486_kon_6.webp&quot;</span>,</span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729428993734_kon_18.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729428993850_kon_19.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729428996317_kon_20.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429001817_kon_21.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429002735_kon_22.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429000558_kon_23.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429003335_kon_24.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429007799_kon_25.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729428998336_kon_26.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429009566_kon_27.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429003993_kon_28.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429003878_kon_29.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429010529_kon_30.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429007853_kon_31.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429008008_kon_32.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429010316_kon_33.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429013647_kon_15.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429006011_kon_16.webp&quot;</span>, </span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429018278_kon_17.webp&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">sp</span>: [</span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729306222386_summer pockets_1.webp&quot;</span>,</span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729306218357_summer pockets_12.webp&quot;</span>,</span><br><span class="line">            <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729306217685_summer pockets_3.webp&quot;</span></span><br><span class="line">        ]</span><br><span class="line">        <span class="comment">// 可以在此添加更多主题</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取随机图片的函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getRandomCoverImage</span>(<span class="params">theme</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> themeImages = themes[theme];</span><br><span class="line">        <span class="keyword">if</span> (themeImages &amp;&amp; themeImages.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> coverImage = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">let</span> attempt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">const</span> maxAttempts = <span class="number">10</span>; <span class="comment">// 最大尝试次数</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (!coverImage &amp;&amp; attempt &lt; maxAttempts) &#123;</span><br><span class="line">                <span class="keyword">const</span> randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * themeImages.<span class="property">length</span>);</span><br><span class="line">                coverImage = themeImages[randomIndex];</span><br><span class="line">                attempt++;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!coverImage) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;获取图片失败，重新尝试...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果仍然没有有效图片，返回一个默认图片</span></span><br><span class="line">            <span class="keyword">return</span> coverImage || <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429018278_kon_17.webp&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;Theme not defined or no images available.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;https://cloudflare-imgbed-9os.pages.dev/file/1729429018278_kon_17.webp&quot;</span>; <span class="comment">// 默认图片链接</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取当天的主题</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getDailyTheme</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> today = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="keyword">const</span> dayOfYear = <span class="title class_">Math</span>.<span class="title function_">floor</span>((today - <span class="keyword">new</span> <span class="title class_">Date</span>(today.<span class="title function_">getFullYear</span>(), <span class="number">0</span>, <span class="number">0</span>)) / <span class="number">86400000</span>);</span><br><span class="line">        <span class="keyword">const</span> themeNames = <span class="title class_">Object</span>.<span class="title function_">keys</span>(themes);</span><br><span class="line">        <span class="keyword">const</span> themeIndex = dayOfYear % themeNames.<span class="property">length</span>;</span><br><span class="line">        <span class="keyword">return</span> themeNames[themeIndex];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">updateCategoryBarCover</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> theme = <span class="variable language_">window</span>.<span class="property">selectedTheme</span> === <span class="string">&#x27;&#x27;</span> ? <span class="title function_">getDailyTheme</span>() : <span class="variable language_">window</span>.<span class="property">selectedTheme</span>;</span><br><span class="line">        <span class="keyword">const</span> categoryItems = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.categoryBar-list-item&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!categoryItems || categoryItems.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;未找到任何分类项元素，确保页面结构正确。&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;当前磁贴主题:&quot;</span>, theme);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;选中的分类项数量:&quot;</span>, categoryItems.<span class="property">length</span>);</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 使用 IntersectionObserver 进行懒加载</span></span><br><span class="line">        <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(<span class="function">(<span class="params">entries</span>) =&gt;</span> &#123;</span><br><span class="line">            entries.<span class="title function_">forEach</span>(<span class="function"><span class="params">entry</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (entry.<span class="property">isIntersecting</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> item = entry.<span class="property">target</span>;</span><br><span class="line">                    <span class="keyword">const</span> coverImage = <span class="title function_">getRandomCoverImage</span>(theme).<span class="title function_">replace</span>(<span class="regexp">/ /g</span>, <span class="string">&quot;%20&quot;</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (coverImage) &#123;</span><br><span class="line">                        item.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">`url(<span class="subst">$&#123;coverImage&#125;</span>)`</span>;</span><br><span class="line">                        item.<span class="property">style</span>.<span class="property">backgroundSize</span> = <span class="string">&quot;cover&quot;</span>;</span><br><span class="line">                        item.<span class="property">style</span>.<span class="property">backgroundRepeat</span> = <span class="string">&quot;no-repeat&quot;</span>;</span><br><span class="line">                        item.<span class="property">style</span>.<span class="property">backgroundPosition</span> = <span class="string">&quot;center center&quot;</span>;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;已设置封面图片:&quot;</span>, coverImage);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未能获取有效的封面图片&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 停止观察已加载的元素</span></span><br><span class="line">                    observer.<span class="title function_">unobserve</span>(item);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    </span><br><span class="line">        categoryItems.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            observer.<span class="title function_">observe</span>(item);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 执行更新操作</span></span><br><span class="line">    <span class="title function_">updateCategoryBarCover</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p></p><h4 id="阅读进度按钮问题"><a href="#阅读进度按钮问题" class="headerlink" title="阅读进度按钮问题"></a>阅读进度按钮问题</h4><p><a target="_blank" rel="noopener" href="https://www.fomal.cc/posts/2d7ac914.html">参考链接</a>，但实际使用有bug，目前涉及的需要修改的文件的代码都已更新，解决了bug。</p><h4 id="夜间模式切换"><a href="#夜间模式切换" class="headerlink" title="夜间模式切换"></a>夜间模式切换</h4><p><a target="_blank" rel="noopener" href="https://www.fomal.cc/posts/d739261b.html">参考链接</a>。先按<code>1.0</code>操作再到<code>2.0</code>替换部分<code>1.0</code>内容才能实现。</p><h4 id="gulp全局资源压缩"><a href="#gulp全局资源压缩" class="headerlink" title="gulp全局资源压缩"></a>gulp全局资源压缩</h4><p><a target="_blank" rel="noopener" href="https://akilar.top/posts/49b73b87/">参考链接</a>。但注意，要生成<code>\public</code>文件夹，需要使用<code>hexo generate</code>命令，而不能使用<code>hexo g</code>，真是离谱啊。</p><h4 id="源码连接仓库"><a href="#源码连接仓库" class="headerlink" title="源码连接仓库"></a>源码连接仓库</h4><ul><li><strong>创建存放源码的私有仓库</strong><br>创建仓库存放源码，设为私密。创建完成后，需要把博客的源码<code>push</code>到这里。首先获取远程仓库地址，此处虽然SSH和HTTPS均可。SSH在绑定过<code>ssh key</code>的设备上无需再输入密码，HTTPS则需要输入密码。</li><li><strong>在[Blogroot]路径下<code>右键-&gt;Git Bash Here</code></strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init <span class="comment"># 初始化git</span></span><br></pre></td></tr></table></figure>这一步会在你的博客目录下新建一个<code>.git</code>文件夹。因为是隐藏文件夹，所以需要你先确保当前目录下隐藏文件夹可见才能看到它。</li><li><strong>添加屏蔽项</strong><br>在远端提交前，我们需要先调整一下屏蔽项，能够使用指令进行安装的内容不包括在需要提交的源码内，这样可以显著减少需要提交的文件量和加快提交速度。打开[Blogroot]/.gitignore（也是隐藏文件）,输入以下内容：<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br><span class="line">.deploy_git*/</span><br><span class="line">.idea</span><br><span class="line">themes/butterfly/.git</span><br></pre></td></tr></table></figure>如果不是<code>butterfly</code>主题，记得替换最后一行内容为你自己当前使用的主题。</li><li><strong>第一次push到远程仓库</strong><br><code>右键-&gt;Git Bash Here</code>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add . <span class="comment"># 添加文件到本地仓库</span></span><br><span class="line">git commit -m <span class="string">&quot;自定义内容即可&quot;</span> <span class="comment"># 添加文件描述信息</span></span><br><span class="line">git remote add origin git@github.com:username/YourRepositoryName.git <span class="comment">#链接远程仓库地址，创建主分支</span></span><br></pre></td></tr></table></figure></li><li>偶尔会遇到一些与远端内容不一致的问题，一般是因为在创建远程仓库时点选了生成<code>README.md</code>或者<code>license</code>的选项，输入指令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 要是提示origin已经存在，那么执行</span></span><br><span class="line">git remote <span class="built_in">rm</span> origin</span><br><span class="line"><span class="comment"># 然后再重新尝试</span></span><br><span class="line">git remote add origin git@github.com:username/YourRepositoryName.git</span><br><span class="line"></span><br><span class="line">git pull origin YourBranchName <span class="comment"># 把远程仓库的新增的内容覆盖到本地仓库</span></span><br><span class="line"></span><br><span class="line">git push -u origin YourBranchName -f</span><br><span class="line"><span class="comment"># 把本地仓库的文件推送到远程仓库的主分支，</span></span><br><span class="line"><span class="comment">#YourBranchName记得替换成分支名，一般是master。</span></span><br><span class="line"><span class="comment">#2020年10月后github新建仓库默认分支改为main</span></span><br><span class="line"><span class="comment"># -f 是强制提交，主要是因为前后版本不一致造成的。</span></span><br><span class="line"><span class="comment"># 然后执行以下指令生成网站并部署到 GitHub 上。</span></span><br><span class="line"><span class="comment">#(Hexo部署网站是根据_config.yml内的配置，所以不受影响)</span></span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure></li><li><strong>后续更新仓库</strong><br>只需要在本地bash执行git三连即可推送代码改动到仓库，若添加了自动部署，则可自动在推送的同时更新网站。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;...&quot;</span></span><br><span class="line">git push</span><br><span class="line"><span class="comment"># 将改动推送到 GitHub</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="小知识"><a href="#小知识" class="headerlink" title="小知识"></a>小知识</h4><ul><li><code>\public</code>文件夹是网站展示的内容的文件夹，<code>\source</code>则是存放数据的文件夹，包括发布的文章，页面的md文件等等。而配置网站主题样式之类的一般在<code>\theme\butterfly</code>里面操作，可以添加<code>js、css、img</code>以及其他比如<code>pug</code>等文件吧。</li><li>要改变页面的样式，若需要脚本注入，可在md文件里用<code>script</code>标签进行动态修改，其他简单的不需要用到函数什么的只需要修改样式，可以<code>F12</code>查找要修改的网页元素，然后使用css进行修改，一般可以用一个通用的<code>custom.css</code>在主题配置文件注入即可。</li><li><code>\theme\butterfly\script</code>里的js文件是后端文件，是静态的，需要重启项目才能执行，刷新网页并不会执行，不需要注入，会直接调用，也能直接读取配置文件的参数；<code>\theme\butterfly\source\js</code>里的js文件是前端文件，是动态的，会随着网页刷新再次执行，需要在主题配置文件<em>inject</em>，要获取到配置文件的参数，可以在<code>\theme\butterfly\script</code>创建后端文件，通过<code>window.参数</code>传递配置文件的参数，前端文件再通过<code>window.参数</code>获取到参数。可以利用这一点读取参数进行一些动态刷新操作。</li><li>一般本地资源的调用路径都是以<code>\theme\butterfly\source</code>为根路径吧，比如注入js时路径用<code>\js\xxx.js</code>即可，引用图片时用<code>\img\xxx.jpg</code>即可。</li><li>网页元素，在css中，一般是<code>.class</code>,<code>#id</code>的方式。要想直接改变目标元素的样式，可以<code>F12</code>检查，找到对应元素所在位置，一般双击它在下面栏的样式表会有它和其他元素的依赖关系，直接复制在css中使用即可。如图：<br><p align="center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/style.jpg" alt="示例图片" style="zoom:50%"></p><div class="note info modern"><p>注意：这里使用html语法设置图片时，用的本地图片的话，本地图片需要存到themes/butterfly/source/img里，但是src路径引用的路径需要为/img/xxx.jpg</p></div></li><li>为了防止在PC端顶部菜单栏有时会收起而不是展开状态，在主题配置文件使用了脚本注入，保证在PC端保持展开状态。<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&lt;script&gt;</span></span><br><span class="line">    <span class="string">document.addEventListener(&quot;DOMContentLoaded&quot;,</span> <span class="string">function()</span> &#123;</span><br><span class="line">        <span class="string">var</span> <span class="string">nav</span> <span class="string">=</span> <span class="string">document.getElementById(&quot;nav&quot;);</span></span><br><span class="line">        <span class="string">if</span> <span class="string">(window.innerWidth</span> <span class="string">&gt;=</span> <span class="number">768</span><span class="string">)</span> &#123;</span><br><span class="line">        <span class="string">nav.classList.remove(&quot;hide-menu&quot;);</span></span><br><span class="line">        <span class="string">nav.classList.add(&quot;show&quot;);</span></span><br><span class="line">        <span class="string">console.log(&quot;nav</span> <span class="string">show</span> <span class="string">on</span> <span class="string">PC&quot;);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="string">);</span></span><br><span class="line">   <span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="完善音乐界面-11-16"><a href="#完善音乐界面-11-16" class="headerlink" title="完善音乐界面(11.16)"></a>完善音乐界面(11.16)</h2><p>&emsp;&emsp;在音乐界面增加卡片，用于选择对应主题的歌单。具体实现为：</p><ul><li><p>修改<code>music</code>文件夹里的<code>index.md</code>文件内容，使用外挂标签设置链接卡片，修改后的文件内容为：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 音乐馆</span><br><span class="line"><span class="section"># type: music</span></span><br><span class="line">aplayer: true</span><br><span class="line">top<span class="emphasis">_img: false</span></span><br><span class="line"><span class="emphasis">comments: false</span></span><br><span class="line"><span class="emphasis">aside: false</span></span><br><span class="line"><span class="emphasis">---</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">&#123;% sitegroup %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% site KON, url=/music/kon, screenshot=https://cloudflare-imgbed-9os.pages.dev/file/1729429000558_</span>kon<span class="emphasis">_23.webp, description=轻音永不毕业! %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% site Summer Pockets, url=/music/sp, screenshot=https://cloudflare-imgbed-9os.pages.dev/file/1729919005838_</span>summer pockets<span class="emphasis">_3.webp, description=唯有那份眩目，未曾忘记... %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% site Eva, url=/music/eva, screenshot=https://cloudflare-imgbed-9os.pages.dev/file/1729915127264_</span>EVA<span class="emphasis">_5.webp, description=梦是现实的延续，现实是梦的终结。 %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% site Ghibli, url=/music/ghibli, screenshot=https://cloudflare-imgbed-9os.pages.dev/file/1730449515623_</span>ghibli<span class="emphasis">_22.webp, description=只要有想见的人，自己就不再是孤单一人。 %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% site love, url=/music/love, screenshot=https://cloudflare-imgbed-9os.pages.dev/file/1729765205778_</span>1729764735768.webp, description=心灵补给站。 %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="code">    document.addEventListener(&quot;DOMContentLoaded&quot;, function() &#123;</span></span><br><span class="line"><span class="code">        document.body.classList.add(&#x27;musiccard-page&#x27;); </span></span><br><span class="line"><span class="code">    &#125;);</span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br><span class="line"><span class="code">&lt;/body&gt;</span></span><br></pre></td></tr></table></figure><p>其中，为该页面设置了class为”musiccard-page”，用于调整该页面的css样式。</p></li><li><p>设置该页面的css样式如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.site-card</span> <span class="selector-class">.img</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span> <span class="meta">!important</span>; <span class="comment">/* 设置高度 */</span></span><br><span class="line">  <span class="attribute">overflow</span>: hidden <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.site-card</span> <span class="selector-class">.img</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">object-fit</span>: cover <span class="meta">!important</span>; <span class="comment">/* 图片适应容器 */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.info</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.2rem</span> <span class="meta">!important</span>; <span class="comment">/* 设置标题字体大小 */</span></span><br><span class="line">  <span class="attribute">font-weight</span>: bold <span class="meta">!important</span>; <span class="comment">/* 加粗标题字体 */</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">18</span>, <span class="number">188</span>, <span class="number">240</span>) <span class="meta">!important</span>; <span class="comment">/* 使标题字体颜色更加醒目，采用鲜艳颜色 */</span></span><br><span class="line">  <span class="attribute">text-shadow</span>: <span class="number">2px</span> <span class="number">2px</span> <span class="number">4px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>) <span class="meta">!important</span>; <span class="comment">/* 为标题添加阴影效果，增强对比 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.info</span> <span class="selector-class">.desc</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.2rem</span> <span class="meta">!important</span>; <span class="comment">/* 设置描述字体大小 */</span></span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">500</span> <span class="meta">!important</span>; <span class="comment">/* 为描述设置较轻的粗细 */</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span> <span class="meta">!important</span>; <span class="comment">/* 白色字体 */</span></span><br><span class="line">  <span class="attribute">text-shadow</span>: <span class="number">1px</span> <span class="number">1px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>) <span class="meta">!important</span>; <span class="comment">/* 轻微阴影增强可读性 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.musiccard-page</span> <span class="selector-class">.page</span> <span class="selector-id">#content-inner</span> <span class="selector-id">#page</span> <span class="selector-id">#article-container</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: none <span class="meta">!important</span>;  <span class="comment">/* 移除边框 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;  <span class="comment">/* 移除阴影效果 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 特定页面（如gallery页面）样式设置 */</span></span><br><span class="line"><span class="selector-class">.musiccard-page</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.musiccard-page</span> <span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">5px</span>) <span class="meta">!important</span>; <span class="comment">/* 添加模糊效果，8px 是模糊的强度 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.musiccard-page</span> <span class="selector-id">#web_bg</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>); <span class="comment">/* 调整背景透明度，0.5 为 50% 透明度 */</span></span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>; <span class="comment">/* 使透明覆盖层位于背景图上方 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.musiccard-page</span> <span class="selector-class">.page</span> <span class="selector-id">#page-header</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.musiccard-page</span> <span class="selector-class">.page</span> <span class="selector-id">#content-inner</span> <span class="selector-id">#page</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">border</span>: none <span class="meta">!important</span>;    <span class="comment">/*去除边框*/</span></span><br><span class="line">  backdrop-<span class="attribute">filter</span>: none <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;  <span class="comment">/*去除阴影*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.musiccard-page</span> <span class="selector-class">.page</span> <span class="selector-id">#footer</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.musiccard-page</span> <span class="selector-class">.page</span> <span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: initial <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主要就是去除背景，使边框透明等，还有就是对背景进行适当模糊和透明度处理，去除页脚等。并对每个卡片图片的大小，以及标题描述的文字进行适当处理，使更加醒目。</p></li><li><p>在<code>music</code>文件夹新建存储主题歌单的<code>page</code>界面，这里包括<code>kon</code>、<code>sp</code>等，这些页面里的<code>index.md</code>沿用原本音乐界面格式，歌单id不同，这样就形成了不同卡片主题有着不同歌单。</p></li></ul><h2 id="修改bug-11-23"><a href="#修改bug-11-23" class="headerlink" title="修改bug(11.23)"></a>修改bug(11.23)</h2><ol><li>发现在博客里的公式渲染后出现问题，例如$SrCoO_x$的’_’会被识别为强调文本的作用，实际应表示下标。查找资料后解决如下：最终还是使用已经安装的<code>hexo-renderer-kramed</code>，但需要先执行：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked</span><br></pre></td></tr></table></figure>然后主题配置文件里开启mathjax支持，enable置为true。之后在<code>博客目录\node_modules\kramed\lib\rules\inline.js</code>中做如下变动：<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// em: /^\b<span class="emphasis">_((?:<span class="strong">__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,</span></span></span><br><span class="line"><span class="strong"><span class="emphasis">em: /^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,</span></span></span><br></pre></td></tr></table></figure>原先的正则表达式会识别_和$并用于强调文本，修改后_不会被识别，此后$ $的行内表达式正常渲染。<br>但要进行自动部署，由于是自动重新安装依赖项，所以需要在自动部署代码加入自动修改inline.js内容的脚本。于是在博客根目录创建<code>fix_kramed.js</code>，内容为：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> inlineRulesPath = path.<span class="title function_">join</span>(</span><br><span class="line">    __dirname,</span><br><span class="line">    <span class="string">&#x27;node_modules&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;kramed&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;lib&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;rules&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;inline.js&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(inlineRulesPath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to read inline.js:&#x27;</span>, err);</span><br><span class="line">        process.<span class="title function_">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 原有的 em 规则字符串</span></span><br><span class="line">    <span class="keyword">const</span> originalEmRuleStr = <span class="string">&quot;em: /^\\b_((?:__|[\\s\\S])+?)_\\b|^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)/&quot;</span>;</span><br><span class="line">    <span class="comment">// 新的 em 规则字符串</span></span><br><span class="line">    <span class="keyword">const</span> newEmRuleStr = <span class="string">&quot;em: /^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)/&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查找原有的 em 规则并替换</span></span><br><span class="line">    <span class="keyword">const</span> index = data.<span class="title function_">indexOf</span>(originalEmRuleStr);</span><br><span class="line">    <span class="keyword">if</span> (index !== -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// 替换原有的 em 规则</span></span><br><span class="line">        <span class="keyword">const</span> updatedData = data.<span class="title function_">substring</span>(<span class="number">0</span>, index) + newEmRuleStr + data.<span class="title function_">substring</span>(index + originalEmRuleStr.<span class="property">length</span>);</span><br><span class="line">        fs.<span class="title function_">writeFile</span>(inlineRulesPath, updatedData, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to update inline.js:&#x27;</span>, err);</span><br><span class="line">                process.<span class="title function_">exit</span>(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Successfully updated Kramed rules.&#x27;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Updated Rule:&#x27;</span>, newEmRuleStr);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Original em rule not found.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>原本采用正则表达式匹配原规则再用新规则替换，但一直匹配不到，最后采用字符串替换的方法成功替换了em规则。`autodeploy.yml增加内容：<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装依赖</span></span><br><span class="line">  <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">修改</span> <span class="string">Kramed</span> <span class="string">规则</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">node</span> <span class="string">fix_kramed.js</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生成静态文件</span></span><br></pre></td></tr></table></figure>注意，调试时，可在自动部署代码中加入：<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Debug</span> <span class="string">File</span> <span class="string">Path</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">ls</span> <span class="string">node_modules/kramed/lib/rules</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Output</span> <span class="string">Kramed</span> <span class="string">Rules</span> <span class="string">for</span> <span class="string">Debugging</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">cat</span> <span class="string">node_modules/kramed/lib/rules/inline.js</span></span><br></pre></td></tr></table></figure>用于检查<code>inline.js</code>路径和文件内容，检查是否成功替换。这些操作后，规则修改，自动部署后也能正常渲染行内公式了。</li><li>文章里pdf显示问题解决方法：安装<code>hexo-pdf</code>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-pdf</span><br></pre></td></tr></table></figure>可以在存放静态资源的<code>source</code>文件夹里新建<code>pdf</code>文件夹用于存放pdf资源，在文章里，要显示pdf时，使用命令：<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf /pdf/xxx.pdf %&#125;</span><br></pre></td></tr></table></figure>注意文件名不要含特殊字符。</li><li>音乐播放界面的歌单发现bug，歌单底部歌曲鼠标点击不触发，减小歌单列表长度能解决一点，但后面发现是底部footer元素阻挡，原先只是隐藏但仍存在会影响点击，于是使用脚本自动删除footer后解决，在每个音乐界面的md文件后加入：<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line">document.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; &#123;</span><br><span class="line">  const footer = document.getElementById(&#x27;footer&#x27;);</span><br><span class="line">  if (footer) &#123;</span><br><span class="line"><span class="code">    footer.remove(); // 删除 footer 元素</span></span><br><span class="line"><span class="code">  &#125;</span></span><br><span class="line"><span class="code">&#125;);</span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>之后歌单所有歌曲点击正常。</li></ol><h2 id="优化看板娘-12-09"><a href="#优化看板娘-12-09" class="headerlink" title="优化看板娘(12.09)"></a>优化看板娘(12.09)</h2><p>&emsp;&emsp;原来的看板娘不能随时关闭，而且比较单调，于是在<a target="_blank" rel="noopener" href="https://github.com/stevenjoezhang/live2d-widget.git">这里</a>进行参考，重新设置了看板娘样式。具体步骤为：</p><ol><li>Fork原项目，并在本地<code>git clone</code>fork的项目，为了保持代码清晰和便于回退，保留原分支，创建新分支：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/yourusername/repository-name.git</span><br><span class="line"><span class="built_in">cd</span> repository-name</span><br><span class="line">git checkout -b new-branch-name</span><br></pre></td></tr></table></figure>将<code>new-branch-name</code>替换为要新建的分支名。</li><li>在本地进行代码修改，然后推送到新分支：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .;git commit -m <span class="string">&quot;update on 24.12.08&quot;</span>;git push origin customize</span><br></pre></td></tr></table></figure><code>customize</code>为示例分支。</li><li>由于仓库的资源使用jsdelivr CDN加载，而jsdelivr的缓存机制会导致修改的内容无法及时更新，折腾半天，采用不断打新标签的方式更新代码内容。当有新的代码改动提交时，创建新标签并推送，然后只需要更改链接即可。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .;git commit -m <span class="string">&quot;update on 24.12.08&quot;</span>;git push origin customize;git tag -a v1.0.6 -m <span class="string">&quot;更新代码&quot;</span>;git push origin v1.0.6</span><br></pre></td></tr></table></figure>每次修改代码后，使用上述命令推送内容到仓库，并创建新标签和推送内容。<br>相应地，修改<code>autoload.js</code>的路径链接：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// live2d_path 参数建议使用绝对路径</span></span><br><span class="line"><span class="keyword">const</span> live2d_path = <span class="string">&quot;https://fastly.jsdelivr.net/gh/ei4869/live2d-widget-fork@v1.0.6/&quot;</span>;</span><br></pre></td></tr></table></figure><code>ei4869</code>和<code>live2d-widget-fork</code>分别为用户名和仓库，新的标签<code>@v1.0.6</code>能刷新缓存，同步更新CDN内容。<br>要想删除某个tag时，采用以下命令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag -d v1.0.0;git push origin --delete v1.0.0</span><br></pre></td></tr></table></figure>要想删除除了某个tag(如v1.0.6)外的其他tag时，采用以下命令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git tag | grep -v <span class="string">&#x27;v1.0.6&#x27;</span> | xargs git tag -d;</span><br><span class="line">git ls-remote --tags origin | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | grep -v <span class="string">&#x27;v1.0.6&#x27;</span> | sed <span class="string">&#x27;s|refs/tags/||&#x27;</span> | xargs -I &#123;&#125; git push origin --delete &#123;&#125;</span><br></pre></td></tr></table></figure></li><li>自定义看板娘样式，可以修改<code>live2d-widget-fork</code>里的以下内容：<code>waifu.css</code>用于修改具体网页里呈现的样式，我这里修改了原来的大小(#live2d)，位置(#waifu)，文字框高度(#waifu-tips)等，最主要的<code>autoload.js</code>用来设置主函数，可以修改里面的代码：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  <span class="title function_">initWidget</span>(&#123;</span><br><span class="line">	<span class="attr">waifuPath</span>: live2d_path + <span class="string">&quot;waifu-tips.json&quot;</span>,</span><br><span class="line">	<span class="comment">//apiPath: &quot;https://live2d.fghrsh.net/api/&quot;,</span></span><br><span class="line">	<span class="attr">cdnPath</span>: <span class="string">&quot;https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/&quot;</span>,</span><br><span class="line">	<span class="attr">tools</span>: [<span class="string">&quot;hitokoto&quot;</span>, <span class="string">&quot;switch-model&quot;</span>, <span class="string">&quot;switch-texture&quot;</span>, <span class="string">&quot;photo&quot;</span>, <span class="string">&quot;quit&quot;</span>]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>我这里把功能按钮(<code>tools</code>)减少了两个(纸飞机游戏和模型信息)。通过修改<code>apiPath</code>或<code>cdnPath</code>里的资源可以增添喜欢的模型，这里还没深入了解(这两个只需配置一个即可)。另外<code>waifu-tips.json</code> 中定义了触发条件（selector，CSS 选择器）和触发时显示的文字（text）可以根据需要修改(主要就是改变一些动作触发的对话)，而<code>src/waifu-tips.js</code> 包含了按钮和对话框的逻辑，可以根据代码一步步分析进行个性化配置(还没深入并修改)。目前就只改了tools和css里的配置。</li></ol></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://ei4869.github.io">Rei</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://ei4869.github.io/2024/10/22/Blog%E6%90%AD%E5%BB%BA%E7%9A%84%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/">https://ei4869.github.io/2024/10/22/Blog%E6%90%AD%E5%BB%BA%E7%9A%84%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ei4869.github.io" target="_blank">Rei的小站</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Blog/">Blog</a><a class="post-meta__tags" href="/tags/Hexo/">Hexo</a></div><div class="post_share"><div class="social-share" data-image="https://cloudflare-imgbed-9os.pages.dev/file/1729429010529_kon_30.webp?v=1735920597130" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css" media="print" onload='this.media="all"'><script src="https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2024/11/20/%E6%AF%95%E8%AE%BE%E7%AC%94%E8%AE%B0-%E4%B8%80/" title="毕设笔记(一)"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloudflare-imgbed-9os.pages.dev/file/1729429013647_kon_15.webp?v=1735920597130" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">毕设笔记(一)</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E8%AE%BE%E7%BD%AE%E9%9A%8F%E6%9C%BA%E4%B8%BB%E9%A2%98%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">怎么设置随机主题背景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">随机文章封面背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%B0%8F%E7%AB%99%E8%83%8C%E6%99%AF"><span class="toc-number">1.2.</span> <span class="toc-text">随机小站背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E7%A3%81%E8%B4%B4%E5%B0%81%E9%9D%A2%E8%83%8C%E6%99%AF"><span class="toc-number">1.3.</span> <span class="toc-text">随机磁贴封面背景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%B0%8F%E5%9D%91"><span class="toc-number">2.</span> <span class="toc-text">一些小坑</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%E9%81%87%E5%88%B0%E9%97%AE%E9%A2%98"><span class="toc-number">2.1.</span> <span class="toc-text">自动部署遇到问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo-butterfly-categories-card%E6%8F%92%E4%BB%B6bug"><span class="toc-number">2.2.</span> <span class="toc-text">hexo-butterfly-categories-card插件bug</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E6%A8%B1%E8%8A%B1%E9%A3%98%E8%90%BD%E8%84%9A%E6%9C%AC"><span class="toc-number">2.3.</span> <span class="toc-text">自定义一个樱花飘落脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%86%8C%E7%95%8C%E9%9D%A2%E9%AD%94%E6%94%B9"><span class="toc-number">2.4.</span> <span class="toc-text">相册界面魔改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87%E6%A0%B7%E5%BC%8F%E6%94%B9%E8%BF%9B"><span class="toc-number">2.5.</span> <span class="toc-text">移动端背景图片样式改进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Aplayer%E6%92%AD%E6%94%BE%E5%99%A8"><span class="toc-number">2.6.</span> <span class="toc-text">Aplayer播放器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Aplayer%E6%92%AD%E6%94%BE%E5%99%A8%E9%AD%94%E6%94%B9-%E8%87%AA%E6%94%B9%E7%89%88%E6%9C%AC"><span class="toc-number">2.7.</span> <span class="toc-text">Aplayer播放器魔改(自改版本)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E7%A2%8E%E7%A2%8E%E5%BF%B5-10-25"><span class="toc-number">2.8.</span> <span class="toc-text">其它碎碎念(10.25)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E7%A3%81%E8%B4%B4%E5%B0%81%E9%9D%A2%E7%9A%84bug"><span class="toc-number">2.8.1.</span> <span class="toc-text">随机磁贴封面的bug</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%85%E8%AF%BB%E8%BF%9B%E5%BA%A6%E6%8C%89%E9%92%AE%E9%97%AE%E9%A2%98"><span class="toc-number">2.8.2.</span> <span class="toc-text">阅读进度按钮问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8D%A2"><span class="toc-number">2.8.3.</span> <span class="toc-text">夜间模式切换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gulp%E5%85%A8%E5%B1%80%E8%B5%84%E6%BA%90%E5%8E%8B%E7%BC%A9"><span class="toc-number">2.8.4.</span> <span class="toc-text">gulp全局资源压缩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E8%BF%9E%E6%8E%A5%E4%BB%93%E5%BA%93"><span class="toc-number">2.8.5.</span> <span class="toc-text">源码连接仓库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%9F%A5%E8%AF%86"><span class="toc-number">2.8.6.</span> <span class="toc-text">小知识</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E5%96%84%E9%9F%B3%E4%B9%90%E7%95%8C%E9%9D%A2-11-16"><span class="toc-number">3.</span> <span class="toc-text">完善音乐界面(11.16)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9bug-11-23"><span class="toc-number">4.</span> <span class="toc-text">修改bug(11.23)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E7%9C%8B%E6%9D%BF%E5%A8%98-12-09"><span class="toc-number">5.</span> <span class="toc-text">优化看板娘(12.09)</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Rei</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><span id="percent">0 %</span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight,500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.33/fancybox/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/node-snackbar/0.1.16/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"></div><script>document.addEventListener("DOMContentLoaded",(function(){var n=document.getElementById("nav");window.innerWidth>=768&&(n.classList.remove("hide-menu"),n.classList.add("show"),console.log("nav show on PC"))}))</script><script async data-pjax src="/js/random_mag_bg.js"></script><script async data-pjax src="/js/randombg.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/cursor.js"></script>><script async src="//at.alicdn.com/t/c/font_4717182_qr9jlst5ym.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script defer data-pjax src="/js/sun_moon.js"></script><div class="aplayer no-destroy" data-id="8881745341" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false"></div><script src="/js/hidelrc.js"></script><script src="https://fastly.jsdelivr.net/gh/ei4869/live2d-widget-fork@v1.0.8/autoload.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script data-pjax>function butterfly_categories_card_injector_config(){var a=document.getElementById("recent-posts");console.log("已挂载butterfly_categories_card"),a.insertAdjacentHTML("afterbegin",'<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(null);"> <a class="categoryBar-list-link" href="categories/整活探索/">整活探索</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(null);"> <a class="categoryBar-list-link" href="categories/科研笔记/">科研笔记</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(null);"> <a class="categoryBar-list-link" href="categories/文献翻译/">文献翻译</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr"></span></li></ul></div></div>')}document.getElementById("recent-posts")&&"/"===location.pathname&&butterfly_categories_card_injector_config()</script><script data-pjax>function butterfly_footer_beautify_injector_config(){var A=document.getElementById("footer-wrap");console.log("已挂载butterfly_footer_beautify"),A.insertAdjacentHTML("beforeend",'<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_footer_beautify_injector_config()</script><script async src="/js/runtime.js"></script><script data-pjax>function butterfly_swiper_injector_config(){var s=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),s.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/10/22/Blog搭建的一些知识点/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloudflare-imgbed-9os.pages.dev/file/1729429010529_kon_30.webp?v=1735920597130" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-22</span><a class="blog-slider__title" href="2024/10/22/Blog搭建的一些知识点/" alt="">Blog搭建的一些知识点</a><div class="blog-slider__text">记录一下搭建Blog的一些知识点</div><a class="blog-slider__button" href="2024/10/22/Blog搭建的一些知识点/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/12/05/2dfan自动签到/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloudflare-imgbed-9os.pages.dev/file/1729429003335_kon_24.webp?v=1735920597130" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-12-05</span><a class="blog-slider__title" href="2024/12/05/2dfan自动签到/" alt="">2dfan自动签到</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2024/12/05/2dfan自动签到/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/12/09/文献翻译-七/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloudflare-imgbed-9os.pages.dev/file/1729306191486_kon_6.webp?v=1735920597130" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-12-09</span><a class="blog-slider__title" href="2024/12/09/文献翻译-七/" alt="">文献翻译(七)</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2024/12/09/文献翻译-七/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/11/23/毕设笔记-四/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloudflare-imgbed-9os.pages.dev/file/1729429007799_kon_25.webp?v=1735920597130" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-23</span><a class="blog-slider__title" href="2024/11/23/毕设笔记-四/" alt="">毕设笔记(四)</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2024/11/23/毕设笔记-四/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="/",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("pagination"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__backInUp"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script></body></html>